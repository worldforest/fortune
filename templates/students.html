<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>교육생 등록 · TMI 저장</title>
    <style>
        body { font-family: IsYun; background: linear-gradient(135deg,#dff7e0 0%,#fff9db 100%); padding: 24px; }
        .card { max-width:720px; margin: 0 auto; background: #fff; padding: 24px; border-radius:12px; box-shadow:0 8px 30px rgba(0,0,0,0.08);} 
        h1{ color:#3ea34b; text-align:center }
        form { display:flex; gap:10px; flex-wrap:wrap }
        input, textarea { padding:10px; border:2px solid #7ccf6c; border-radius:8px; font-size:1rem; }
        textarea{ min-height:80px; flex:1 }
        .btn { background:linear-gradient(135deg,#7ccf6c 0%,#ffd54a 100%); color:#fff; border:none; padding:10px 18px; border-radius:8px; cursor:pointer }
        .list { margin-top:20px }
        .student { padding:10px; border-bottom:1px solid #eee }
        .student .name { font-weight:bold }
        .success{ color:#27ae60 }
        .error{ color:#e74c3c }
        a.back { display:inline-block; margin-bottom:12px; color:#3ea34b }
    </style>
</head>
<body>
    <div class="card">
        <a class="back" href="/">← 메인으로 돌아가기</a>
        <h1>➕ 교육생 등록 · TMI 저장</h1>
        <p style="color:#666">이 페이지에서 교육생 이름과 TMI를 한 번에 등록합니다.</p>

        <div id="message"></div>

        <form id="addForm" onsubmit="event.preventDefault(); submitForm();">
            <input id="name" placeholder="이름 (예: 김철수)" required />
            <textarea id="tmi" placeholder="TMI를 입력하세요 (예: 고양이를 좋아함)" required></textarea>
            <button class="btn" type="submit">저장</button>
        </form>

        <div class="list">
            <h3>등록된 교육생</h3>
            <div id="studentsList">
                <!-- 서버에서 렌더링된 리스트가 있으면 여기에 표시 -->
            </div>
        </div>
    </div>

    <script>
        function submitForm(){
            const name = document.getElementById('name').value.trim();
            const tmi = document.getElementById('tmi').value.trim();
            const msg = document.getElementById('message');
            if(!name || !tmi){ msg.innerHTML = '<p class="error">이름과 TMI를 모두 입력하세요.</p>'; return }
            fetch('/api/add-student', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({name:name,tmi:tmi}) })
            .then(r=>r.json()).then(j=>{
                if(j.success){ msg.innerHTML = '<p class="success">저장되었습니다.</p>'; addStudentToList(name); document.getElementById('addForm').reset(); }
                else msg.innerHTML = '<p class="error">오류: '+(j.error||'알 수 없음')+'</p>'
            }).catch(e=>{ msg.innerHTML = '<p class="error">오류가 발생했습니다.</p>'; console.error(e)})
        }
        function addStudentToList(name){ const container = document.getElementById('studentsList'); const div = document.createElement('div'); div.className='student'; div.innerHTML = `<div class="name">${name}</div>`; container.prepend(div) }
        // 초기 로드: 서버에서 학생 목록 가져오기
        fetch('/api/list-students').then(r=>r.json()).then(j=>{ if(j.success && j.data){ const container = document.getElementById('studentsList'); j.data.forEach(s=>{ const div=document.createElement('div'); div.className='student'; div.innerHTML=`<div class="name">${s.name}</div><div class="tmi">${s.tmi||''}</div>`; container.appendChild(div) }) } })
    </script>
</body>
</html>